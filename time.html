<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pick Time</title>
  <link rel="stylesheet" href="style.css"/>
</head>

<body class="rose">
  <!-- ğŸŒ¹ Rose bubble layer -->
  <div class="rose-bubbles" id="roseBubbles"></div>

  <main class="card">
    <h1>One last thing â°ğŸŒ¹</h1>
    <p class="sub"><b>What time suits you?</b></p>

    <section class="grid" id="timeGrid" style="grid-template-columns: repeat(3, minmax(0,1fr));">
      <div class="choice" data-time="7pm">
        <div class="top">
          <div class="name">7pm</div>
          <div class="tag">ğŸŒ™</div>
        </div>
        <div class="ex">Early evening vibes</div>
      </div>

      <div class="choice" data-time="8pm">
        <div class="top">
          <div class="name">8pm</div>
          <div class="tag">âœ¨</div>
        </div>
        <div class="ex">Perfect dinner time</div>
      </div>

      <div class="choice" data-time="9pm">
        <div class="top">
          <div class="name">9pm</div>
          <div class="tag">ğŸŒŸ</div>
        </div>
        <div class="ex">Late & chill</div>
      </div>
    </section>

    <div class="result" id="result"></div>

    <div class="footer-actions">
      <button class="btn primary" id="finishBtn" style="display:none;">Finish âœ…</button>
      <button class="smallbtn" onclick="window.location.href='food.html'">â† Back</button>
    </div>

    <div class="finalbox" id="finalBox" style="display:none;"></div>
  </main>

  <!-- Shared helpers -->
  <script src="app.js"></script>

  <script>
    /* ğŸŒ¹ Rose bubble animation */
    (function roseBubbles(){
      const wrap = document.getElementById("roseBubbles");
      if(!wrap) return;

      const roses = ["ğŸŒ¹","ğŸŒ¸","ğŸ’®","ğŸŒº"];
      const maxOnScreen = 18;

      function spawn(){
        if(wrap.children.length > maxOnScreen) return;

        const el = document.createElement("div");
        el.className = "rose-bubble";
        el.textContent = roses[Math.floor(Math.random() * roses.length)];

        const left = Math.random() * 100;
        const size = 16 + Math.random() * 22;
        const dur  = 6 + Math.random() * 8;
        const drift = (Math.random() * 120 - 60);
        const spin = (Math.random() * 220 - 110);
        const scale = 0.85 + Math.random() * 0.7;

        el.style.left = left + "vw";
        el.style.fontSize = size + "px";
        el.style.animationDuration = dur + "s";
        el.style.setProperty("--drift", drift + "px");
        el.style.setProperty("--spin", spin + "deg");
        el.style.setProperty("--scale", scale);

        wrap.appendChild(el);
        setTimeout(() => el.remove(), (dur + 0.5) * 1000);
      }

      for(let i=0;i<8;i++) spawn();
      setInterval(spawn, 650);
    })();

    /* ğŸ‡ Confetti */
    function launchConfetti(){
      const colors = ["#ff2d55", "#ff7aa8", "#ffd1dc", "#ff9bb8", "#ffc0cb"];
      const count = 120;

      for(let i=0;i<count;i++){
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random() * 100 + "vw";
        c.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
        c.style.animationDuration = (3 + Math.random()*3) + "s";
        c.style.transform = `rotate(${Math.random()*360}deg)`;
        document.body.appendChild(c);
        setTimeout(()=>c.remove(), 6000);
      }
    }

    /* â° Time selection logic */
    const result = document.getElementById("result");
    const finishBtn = document.getElementById("finishBtn");
    const finalBox = document.getElementById("finalBox");

    let selectedTime = null;

    makeSelectable("#timeGrid", ".choice", "chosen", (card) => {
      selectedTime = card.getAttribute("data-time");
      saveData({ time: selectedTime });
      result.textContent = `Perfect âœ… ${selectedTime} works!`;
      finishBtn.style.display = "inline-block";
    });

    finishBtn.addEventListener("click", () => {
      const data = getData();

      launchConfetti();

      finalBox.style.display = "block";
      finalBox.innerHTML =
        `Food: <b>${data.food || "â€”"}</b> ğŸ½ï¸<br/>` +
        `Time: <b>${data.time || "â€”"}</b> â°<br/><br/>` +
        `See you then, until that take care.<br/>Thanks for making out some time !! â¤ï¸`;

      finishBtn.disabled = true;
      finishBtn.textContent = "Done ğŸ‰";
    });
  </script>
</body>
</html>

